{"version":3,"sources":["golf.js","modify_password.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"modify_password.js","sourcesContent":["(function($){\r\n\r\n    $.ajaxSetup({\r\n        headers: {\r\n            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n        }\r\n    });\r\n\r\n    $.golf = {\r\n        // 验证规则\r\n        validator: {\r\n\r\n            // 手机号\r\n            phone: function(phone) {\r\n                var reg = /^0?1[3|4|5|8][0-9]\\d{8}$/;\r\n                return reg.test(phone);\r\n            }\r\n        },\r\n\r\n        // 3秒后重定向\r\n        forward: function(url) {\r\n            if (url) {\r\n                setTimeout(function() {\r\n                    window.location = url;\r\n                }, 3000);\r\n            }\r\n        },\r\n\r\n        // 在表单输出错误消息\r\n        formError: function(msg) {\r\n            var html = '<div class=\"alert alert-danger alert-dismissible\" role=\"alert\">';\r\n                html += '<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'\r\n                html += '<strong>'+msg+'</strong>'\r\n                html += '</div>';\r\n            $('#errors').html(html);\r\n        },\r\n\r\n        // 清除表单错误消息\r\n        cleanFormError: function() {\r\n            $('#errors').html('');\r\n        }\r\n    }\r\n})(jQuery);","$(function() {\r\n\r\n    var iptPhone = $('input[name=phone]');\r\n    var iptSmsCode = $('input[name=sms_code]');\r\n    var iptNowPassword = $('input[name=now_password]');\r\n    var iptPassword = $('input[name=password]');\r\n    var iptPasswordConfirmation = $('input[name=password_confirmation]');\r\n    var btnSmsCode = $('#btnSmsCode');\r\n    var form = $('#form');\r\n\r\n    // 表单提交\r\n    form.submit(function() {\r\n        $.golf.cleanFormError();\r\n\r\n        var phone = iptPhone.val();\r\n        var smsCode = iptSmsCode.val();\r\n        var nowPassword = iptNowPassword.val();\r\n        var password = iptPassword.val();\r\n        var passwordConfirm = iptPasswordConfirmation.val();\r\n\r\n        if (!$.golf.validator.phone(phone)) {\r\n            $.golf.formError(iptPhone.data('validator'));\r\n            iptPhone.focus();\r\n            return false;\r\n        }\r\n\r\n        if (!smsCode) {\r\n            $.golf.formError(iptSmsCode.data('validator'));\r\n            iptSmsCode.focus();\r\n            return false;\r\n        }\r\n\r\n        if (!nowPassword) {\r\n            $.golf.formError(iptNowPassword.data('validator'));\r\n            iptNowPassword.focus();\r\n            return false;\r\n        }\r\n\r\n        if (password.length < 6 || password.length > 18) {\r\n            $.golf.formError(iptPassword.data('validator'));\r\n            iptPassword.focus();\r\n            return false;\r\n        }\r\n\r\n        if (passwordConfirm != password) {\r\n            $.golf.formError(iptPasswordConfirmation.data('validator'));\r\n            iptPasswordConfirmation.focus();\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    });\r\n\r\n    // 获取验证码\r\n    btnSmsCode.click(function() {\r\n        var phone = iptPhone.val();\r\n        var html = btnSmsCode.html();\r\n\r\n        if (!$.golf.validator.phone(phone)) {\r\n            $.golf.formError(iptPhone.data('validator'));\r\n            return false;\r\n        }\r\n\r\n        $.ajax({\r\n            url: '/auth/sms-code',\r\n            data: {phone: phone},\r\n            beforeSend: function() {\r\n                $.golf.cleanFormError();\r\n                btnSmsCode.attr('disabled', 'disabled');\r\n            },\r\n            complete: function(resp) {\r\n                if (resp.status == 200 && resp['responseJSON']) {\r\n                    var obj = resp['responseJSON'];\r\n                    var time = 0;\r\n                    if (obj['status'] == 1 || obj['status'] == -3) {\r\n                        var timer = setInterval(function() {\r\n                            if(time < obj['data']) {\r\n                                btnSmsCode.html((obj['data']-time)+'秒后重新获取');\r\n                                time++;\r\n                            } else {\r\n                                btnSmsCode.removeAttr('disabled');\r\n                                btnSmsCode.html(html);\r\n                                clearInterval(timer);\r\n                            }\r\n                        }, 1000);\r\n                    } else {\r\n                        $.golf.formError(obj['msg']);\r\n                    }\r\n\r\n                } else {\r\n                    $.golf.formError('网络请求失败');\r\n                    btnSmsCode.removeAttr('disabled');\r\n                }\r\n            }\r\n        });\r\n    });\r\n});"],"sourceRoot":"/source/"}